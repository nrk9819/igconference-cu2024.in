---
import CountrySelect from "../CountrySelect.astro";
import ThemesSelect from "../ThemesSelect.astro";
---

<!-- General Information for main author-->
<div class="mb-8 md:mb-10 flex flex-col rounded-lg overflow-hidden border border-slate-200">
    <div class="px-8 md:px-12 py-6 bg-slate-50 border-b border-slate-200">
        <h2 class="text-xl font-medium">General Information of Corresponding Author</h2>
    </div>
    <div class="px-8 md:px-12 py-8 bg-white">
        <form id="author" enctype="multipart/form-data"  class="text-md md:text-lg">
           <!-- Title (Mr./Ms./Dr./Other) -->
            <div class="mb-6">
                <label for="title" class="block mb-2">Title (Dr./ Mr./ Ms./ Other)</label>
                <input type="text" id="title" name="title" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- First Name -->
            <div class="mb-6">
                <label for="first_name" class="block mb-2">First Name</label>
                <input type="text" id="first_name" name="first_name" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- Last Name -->
            <div class="mb-6">
                <label for="last_name" class="block mb-2">Last Name</label>
                <input type="text" id="last_name" name="last_name" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- Position/Designation -->
            <div class="mb-6">
                <label for="position" class="block mb-2">Position</label>
                <input type="text" id="position" name="position" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- University/Organization -->
            <div class="mb-6">
                <label for="organization" class="block mb-2">University/Organization</label>
                <input type="text" id="organization" name="organization" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- Country Select -->
            <div class="mb-6">
                <label for="country" class="block mb-2">Country</label>
                <CountrySelect />
            </div>
            

            <!-- Email -->
            <div class="mb-6">
                <label for="email" class="block mb-2">Email</label>
                <input type="email" id="email" name="email" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- Phone No -->
            <div class="mb-6">
                <label for="phone" class="block mb-2">Phone Number</label>
                <input type="tel" id="phone" name="phone" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
            </div>
    
            <!-- Certificate from Institution for their Status (Image Upload) -->
            <div class="mb-8">
                <label for="certificate" class="block mb-4">Certificate from Institution for their status (JPEG or PNG only)</label>
                <input type="file" id="certificate" name="certificate" accept=".jpeg, .jpg, .png" required>
            </div>
    
            <!-- Age Proof (Image Upload) -->
            <div class="mb-6">
                <label for="age_proof" class="block mb-4">Age Proof (AADHAR/PAN in JPEG or PNG only)</label>
                <input type="file" id="age_proof" name="age_proof" accept=".jpeg, .jpg, .png" required>
            </div>
        </form>
    </div>
</div>

<!-- Abstract Details -->
<div class="mb-6 md:mb-8 flex flex-col rounded-lg overflow-hidden border border-slate-200">
    <div class="px-8 md:px-12 py-6 bg-slate-50 border-b border-slate-200">
        <h2 class="text-xl font-medium">Abstract Details</h2>
    </div>
    <div class="px-8 md:px-12 py-6 bg-white">
        <form enctype="multipart/form-data" id="abstract" class="text-md md:text-lg">
            <!-- Title of the Paper -->
          <div class="mb-6">
            <label for="paper_title" class="block mb-2">Title of the Paper</label>
            <input type="text" id="paper_title" name="paper_title" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
        </div>

            <!-- Theme -->
          <div class="mb-6">
            <label for="paper_title" class="block mb-2">Subtheme</label>
            <ThemesSelect/>
        </div>

        <!-- Name of the Author (Corresponding Author) -->
        <div class="mb-6">
            <label for="author_name" class="block mb-2">Name of the Author (Corresponding Author)</label>
            <input type="text" id="author_name" name="author_name" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
        </div>

        <!-- Email of Corresponding Author -->
        <div class="mb-6">
            <label for="author_email" class="block mb-2">Email of Corresponding Author</label>
            <input type="email" id="author_email" name="author_email" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
        </div>

        <!-- Additional Authors -->
        <div id="additional_authors"></div>

        <!-- Add More Author Button -->
        <button type="button" id="add_author_button" class="block ml-auto mb-6 py-2 px-4 text-md text-green-900 disabled:text-gray-400 rounded-xl bg-green-300 disabled:bg-gray-200">Add Author</button>

        <!-- Abstract -->
        <div class="mb-6">
            <label for="abstract" class="block mb-2">Abstract (Maximum number of words is 300)</label>
            <textarea id="abstract" name="abstract" class="w-full h-96 py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white"></textarea>
        </div>

        <!-- Keywords (Up to 5 semicolon-separated values) -->
        <div class="mb-6">
            <label for="keywords" class="block mb-2">Keywords (Up to 5 semicolon-separated values)</label>
            <input type="text" id="keywords" name="keywords" class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
        </div>
    </form>
    </div>
    <button id="submitForms" class=`px-5 md:px-6 py-3 md:py-4 font-medium md:text-lg text-white disabled:opacity-40 leading-none bg-green-900 disabled:bg-gray-400 enabled:hover:bg-green-800`>
        Submit Form
    </button>
</div>
    
<script>
    const addAuthorBtn = document.getElementById('add_author_button')
    const additionalAuthorsContainer = document.getElementById('additional_authors');
    const submitFormsBtn = document.getElementById('submitForms')
    let authorCounter = 1;

    addAuthorBtn.addEventListener('click', () => {
        if(authorCounter <= 4) {
            authorCounter++;
            const authorDiv = document.createElement('div');
            authorDiv.classList.add("mb-6")
            authorDiv.innerHTML = `
                    <label for="author_name_${authorCounter}" class="block mb-2">Name of Author ${authorCounter}:</label>
                    <input type="text" id="author_name_${authorCounter}" name="author_name_${authorCounter}" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
                    <label for="author_email_${authorCounter}" class="block mb-2">Email of Author ${authorCounter}:</label>
                    <input type="email" id="author_email_${authorCounter}" name="author_email_${authorCounter}" required class="w-full py-3 px-4 border rounded border-slate-300 bg-slate-50 focus:bg-white">
                `;
                additionalAuthorsContainer.appendChild(authorDiv);

                if(authorCounter === 5) addAuthorBtn.disabled = true
        } 
    })

    // function to handle form submission
    function submitForms() {
        const authorForm = document.getElementById('author')
        const abstractForm = document.getElementById('abstract')

        const authorData = new FormData(authorForm)
        const abstractData = new FormData(abstractForm)

        const allFormData = {
            authorForm: Object.fromEntries(authorData),
            abstractForm: Object.fromEntries(abstractData)
        }
        console.log(allFormData)
    }

    submitFormsBtn.addEventListener('click', submitForms)
    
</script>